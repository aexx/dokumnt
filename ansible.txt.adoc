
== Ansible


=== Control node

.Install on Control node
----
sudo apt install openssh-server
sudo adduser ansible
sudo vi /etc/sudoers.d/ansible
$ nl /etc/sudoers.d/ansible
     1  ansible ALL=(ALL:ALL) NOPASSWD:ALL
# Login als ansible
sudo apt install -y software-properties-common
sudo apt install python -y
sudo apt-add-repository ppa:ansible/ansible
sudo apt install ansible -y
#
$ cd ; ansible-config init --disabled -t all > ansible.cfg
sudo mkdir /etc/ansible/
sudo vi /etc/ansible/hosts
ansible@tine-Inspi-1520:~$ nl /etc/ansible/hosts
     1  [myhosts]
     2  aspix3950
     3  latitude
     4  tuxedo
ansible@tine-Inspi-1520:~$ 
#
ssh-keygen
ssh-copy-id ansible@aspix395
ssh-copy-id ansible@tuxedo0
$ ansible all -m ping  ## or $ ansible aspix3950 -m ping
tuxedo | SUCCESS => {
    "ansible_facts": {
        "discovered_interpreter_python": "/usr/bin/python3.12"
    },
    "changed": false,
    "ping": "pong"
}
aspix3950 | SUCCESS => {
    "ansible_facts": {
        "discovered_interpreter_python": "/usr/bin/python3.12"
    },
    "changed": false,
    "ping": "pong"
}
#
vi apt-pakete-installieren.yaml
ansible-playbook apt-pakete-installieren.yaml --syntax-check
ansible-playbook apt-pakete-installieren.yaml --check
#
sudo apt install git
cd && mkdir -p githubaexx && cd githubaexx && git clone https://github.com/aexx/skript
# Fuer update
cd ~/githubaexx/skript && git pull
----


=== Managed Node

.Changed on Managed Node
----
# aspix3950 und tuxedo
dpkg -l|egrep -i python
sudo apt install python-is-python3 -y
sudo adduser ansible
sudo vi /etc/sudoers.d/ansible
$ nl /etc/sudoers.d/ansible
     1  ansible ALL=(ALL:ALL) NOPASSWD:ALL
#
----


=== Playbooks

link:https://github.com/aexx/skript/blob/main/ansible/apt-pakete-installieren.yaml[Playbook: apt-pakete-installieren.yaml => https://github.com/aexx/skript/blob/main/ansible/apt-pakete-installieren.yaml]

.playbook: apt-pakete-installieren.yaml
----
ansible-playbook githubaexx/skript/ansible/apt-pakete-installieren.yaml -e myhosts=aspix3950 --check
----

link:https://github.com/aexx/skript/blob/main/ansible/dateien-kopieren.yaml[Playbook: dateien-kopieren.yaml => https://github.com/aexx/skript/blob/main/ansible/dateien-kopieren.yaml]

.playbook: dateien-kopieren.yaml
----
ansible-playbook ~/githubaexx/skript/ansible/dateien-kopieren.yaml -e myhosts=aspix3950 --check -vv
ansible-playbook ~/githubaexx/skript/ansible/dateien-kopieren.yaml -e myhosts=aspix3950
----

link:https://github.com/aexx/skript/blob/main/ansible/[Playbooks]



